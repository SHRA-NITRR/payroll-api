USE [VYPAK]
GO
/****** Object:  StoredProcedure [dbo].[Proc_Employee_Details]    Script Date: 23/02/2019 1:15:14 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
 
ALTER PROCEDURE [dbo].[Proc_Employee_Details]

 (

@EmployeeId int= NULL,
@Employee_Title varchar(10)= NULL,
@Employee_Name varchar(85)=NULL,
@FathersName varchar(100)=NULL,
@MothersName varchar(100)=NULL,
@NomineeName varchar(47)=NULL,
@Gender varchar(20)=NULL,
@Occupation varchar(200) =NULL,
@Division varchar(200) =NULL,
@Grade varchar(100) =NULL,
@Emp_Attendance varchar(50)=NULL,
@BloodGroup varchar(20)=NULL,
@DateOfBirth varchar(50)= NULL,
@Present_Res_No varchar(30)= NULL,
@Present_Res_Name varchar(100)= NULL,
@Present_Road varchar(100) =NULL,
@Present_Area varchar(100)= NULL,
@Present_City varchar(30)= NULL,
@Present_State varchar(30)=NULL,
@Present_Pincode varchar(6)=NULL,
@Permanent_Res_No varchar(30)= NULL,
@Permanent_Res_Name varchar(100)= NULL,
@Permanent_Road varchar(100)= NULL,
@Permanent_Area varchar(100)= NULL,
@Permanent_City varchar(30)= NULL,
@Permanent_State varchar(30)= NULL,
@Permanent_Pincode varchar(6)= NULL,
@Marital_Status varchar(10)= NULL,
@Ward_Circle varchar(50)=NULL,
@BankAcNo varchar(30)=NULL,
@Bank_Name varchar(30)=NULL,
@Branch_Name varchar(50)=NULL,
@Email_ID varchar(50)=NULL,
@Is_Default_EmailId bit= NULL,
@Alt_Email_ID varchar(50)=NULL,
@Is_Default_Alt_EmailId bit=NULL,
@CC_Email_ID varchar(50)=NULL,
@STD_Code varchar(15)=NULL,
@PhoneNo varchar(15)=NULL,
@Mobile varchar(15)=NULL,
@PANno varchar(50)=NULL,
@AAdhar_No varchar(50)= NULL,
@VoterId varchar(50)=NULL,
@PassportNo varchar(50)=NULL,
@Marriage_Date varchar(50)=NULL,
@Department_Id int= NULL,
@Desig_Id int=NULL,
@Emp_Cate_Id int= NULL,
@Employee_Image varchar(50)= NULL,
@Date_of_Join varchar(50)=NULL,
@Salary_Calc_From varchar(50)=NULL,
@Is_Leaving bit=NULL,
@Date_of_Leave varchar(50)=NULL,
@Reason_Of_Leave varchar(250)=NULL,
@Past_Service_inDay int= NULL,
@IsESI bit =NULL,
@ESI_No varchar(30)=NULL,
@ESI_Dispensary varchar(50)=NULL,
@IsPF bit=NULL,
@PF_No varchar(30)= NULL,
@PF_Dept_File varchar(50)=NULL,
@Is_Restrict_PF bit=NULL,
@Is_Zero_Pension bit=NULL,
@Is_Zero_PT bit=NULL,
@IsGRI bit=NULL,
@GRI_No varchar(30)=NULL,
@IsInsurance bit=NULL,
@Insurance_No varchar(30)=NULL,
@IsDisabled varchar(1)=NULL,
@IsInternationalworker varchar(1)=NULL,
@IsHigherEPF varchar(1)=NULL,
@IsHigherEPS varchar(1)=NULL,
@Created_By int=NULL,
@Created_On datetime=NULL,
@Modified_By int=NULL,
@Modified_On datetime=NULL,
@Is_Deleted bit= NULL,
@OUT_CODE VARCHAR(30)=null,
@Operation varchar(30)=null,
@Date  nvarchar(40)=null,
@id varchar(50)= NULL
            
)

 AS
 SET NOCOUNT ON 
 
  IF @Operation='INSERT'
   BEGIN
SET @Salary_Calc_From=(SELECT Convert(date,@Salary_Calc_From, 103) AS Salary_Calc_From)

SET @Marriage_Date=(SELECT Convert(date,@Marriage_Date, 103) AS Marriage_Date)

SET @Date_of_Leave=(SELECT Convert(date,@Date_of_Leave, 103) AS Date_of_Leave)

SET @Date_of_Join=(SELECT Convert(date,@Date_of_Join, 103) AS Date_of_Join)

SET @DateOfBirth=(SELECT Convert(date,@DateOfBirth, 103) AS DateOfBirth)
BEGIN
DECLARE @Employee_Code VARCHAR(20)
SET @EmployeeId=(SELECT ISNULL(MAX(EmployeeId),0)+1 FROM Employee_Details)	
SET @Employee_Code=(SELECT 'EMP'+CAST( ISNULL(MAX(EmployeeId),0)+1 AS VARCHAR(20)) FROM Employee_Details)	

INSERT INTO Employee_Details (
EmployeeId ,
Employee_Code,
Employee_Title ,
Employee_Name ,
FathersName ,
MothersName ,
NomineeName ,
Gender,
Occupation,
Division,
Grade ,
Emp_Attendance ,
BloodGroup ,
DateOfBirth ,
Present_Res_No ,
Present_Res_Name,
Present_Road ,
Present_Area ,
Present_City ,
Present_State ,
Present_Pincode ,
Permanent_Res_No ,
Permanent_Res_Name ,
Permanent_Road ,
Permanent_Area ,
Permanent_City,
Permanent_State ,
Permanent_Pincode ,
Marital_Status ,
Ward_Circle ,
BankAcNo,
Bank_Name,
Branch_Name,
Email_ID,
Is_Default_EmailId,
Alt_Email_ID,
Is_Default_Alt_EmailId,
CC_Email_ID,
STD_Code,
PhoneNo,
Mobile,
PANno,
AAdhar_No,
VoterId,
PassportNo,
Marriage_Date,
Department_Id,
Desig_Id,
Emp_Cate_Id ,
Employee_Image,
Date_of_Join,
Salary_Calc_From,
Is_Leaving,
Date_of_Leave,
Reason_Of_Leave,
Past_Service_inDay,
IsESI,
ESI_No,
ESI_Dispensary,
IsPF,
PF_No,
PF_Dept_File,
Is_Restrict_PF,
Is_Zero_Pension,
Is_Zero_PT,
IsGRI,
GRI_No,
IsInsurance,
Insurance_No,
IsDisabled,
IsInternationalworker,
IsHigherEPF,
IsHigherEPS,
Created_By 
 
)
    VALUES
     (@EmployeeId ,
	 @Employee_Code,
@Employee_Title ,
@Employee_Name ,
@FathersName ,
@MothersName ,
@NomineeName ,
@Gender,
@Occupation,
@Division,
@Grade ,
@Emp_Attendance ,
@BloodGroup ,
@DateOfBirth ,
@Present_Res_No ,
@Present_Res_Name,
@Present_Road ,
@Present_Area ,
@Present_City ,
@Present_State ,
@Present_Pincode ,
@Permanent_Res_No ,
@Permanent_Res_Name ,
@Permanent_Road ,
@Permanent_Area ,
@Permanent_City,
@Permanent_State ,
@Permanent_Pincode ,
@Marital_Status ,
@Ward_Circle ,
@BankAcNo,
@Bank_Name,
@Branch_Name,
@Email_ID,
@Is_Default_EmailId,
@Alt_Email_ID,
@Is_Default_Alt_EmailId,
@CC_Email_ID,
@STD_Code,
@PhoneNo,
@Mobile,
@PANno,
@AAdhar_No,
@VoterId,
@PassportNo,
@Marriage_Date,
@Department_Id,
@Desig_Id,
@Emp_Cate_Id ,
@Employee_Image,
@Date_of_Join,
@Salary_Calc_From,
@Is_Leaving,
@Date_of_Leave,
@Reason_Of_Leave,
@Past_Service_inDay,
@IsESI,
@ESI_No,
@ESI_Dispensary,
@IsPF,
@PF_No,
@PF_Dept_File,
@Is_Restrict_PF,
@Is_Zero_Pension,
@Is_Zero_PT,
@IsGRI,
@GRI_No,
@IsInsurance,
@Insurance_No,
@IsDisabled,
@IsInternationalworker,
@IsHigherEPF,
@IsHigherEPS,@Created_By)
END
END

 IF @Operation='UPDATE'
 
 BEGIN
SET @Salary_Calc_From=(SELECT Convert(date,@Salary_Calc_From, 103) AS Salary_Calc_From)

SET @Marriage_Date=(SELECT Convert(date,@Marriage_Date, 103) AS Marriage_Date)

SET @Date_of_Leave=(SELECT Convert(date,@Date_of_Leave, 103) AS Date_of_Leave)

SET @Date_of_Join=(SELECT Convert(date,@Date_of_Join, 103) AS Date_of_Join)

SET @DateOfBirth=(SELECT Convert(date,@DateOfBirth, 103) AS DateOfBirth)
    
UPDATE Employee_Details SET 
 
Employee_Title=@Employee_Title ,
Employee_Name=@Employee_Name ,
FathersName =@FathersName ,
MothersName=@MothersName ,
NomineeName=@NomineeName ,
Gender=@Gender,
Occupation=@Occupation,
Division=@Division,
Grade=@Grade ,
Emp_Attendance=@Emp_Attendance ,
BloodGroup=@BloodGroup ,
DateOfBirth=@DateOfBirth ,
Present_Res_No=@Present_Res_No ,
Present_Res_Name=@Present_Res_Name,
Present_Road=@Present_Road ,
Present_Area=@Present_Area ,
Present_City=@Present_City ,
Present_State=@Present_State ,
Present_Pincode=@Present_Pincode ,
Permanent_Res_No=@Permanent_Res_No ,
Permanent_Res_Name=@Permanent_Res_Name ,
Permanent_Road=@Permanent_Road ,
Permanent_Area=@Permanent_Area ,
Permanent_City=@Permanent_City,
Permanent_State=@Permanent_State,
Permanent_Pincode=@Permanent_Pincode,
Marital_Status=@Marital_Status,
Ward_Circle=@Ward_Circle ,
BankAcNo=@BankAcNo,
Bank_Name=@Bank_Name,
Branch_Name=@Branch_Name,
Email_ID=@Email_ID,
Is_Default_EmailId=@Is_Default_EmailId,
Alt_Email_ID=@Alt_Email_ID,
Is_Default_Alt_EmailId=@Is_Default_Alt_EmailId,
CC_Email_ID=@CC_Email_ID,
STD_Code=@STD_Code,
PhoneNo=@PhoneNo,
Mobile=@Mobile,
PANno=@PANno,
AAdhar_No=@AAdhar_No,
VoterId=@VoterId,
PassportNo=@PassportNo,
Marriage_Date=@Marriage_Date,
Department_Id=@Department_Id,
Desig_Id=@Desig_Id,
Emp_Cate_Id=@Emp_Cate_Id ,
Employee_Image=@Employee_Image,
Date_of_Join=@Date_of_Join,
Salary_Calc_From=@Salary_Calc_From,
Is_Leaving=@Is_Leaving,
Date_of_Leave=@Date_of_Leave,
Reason_Of_Leave=@Reason_Of_Leave,
Past_Service_inDay=@Past_Service_inDay,
IsESI=@IsESI,
ESI_No=@ESI_No,
ESI_Dispensary=@ESI_Dispensary,
IsPF=@IsPF,
PF_No=@PF_No,
PF_Dept_File=@PF_Dept_File,
Is_Restrict_PF=@Is_Restrict_PF,
Is_Zero_Pension=@Is_Zero_Pension,
Is_Zero_PT=@Is_Zero_PT,
IsGRI=@IsGRI,
GRI_No=@GRI_No,
IsInsurance=@IsInsurance,
Insurance_No=@Insurance_No,
IsDisabled=@IsDisabled,
IsInternationalworker=@IsInternationalworker,
IsHigherEPF=@IsHigherEPF,
IsHigherEPS=@IsHigherEPS,
Modified_By= @Created_By,Modified_On = GETDATE()
WHERE EmployeeId=@EmployeeId
   END
    
   
 IF @Operation='SELECT'
   BEGIN
   SELECT EmployeeId ,
   Employee_Code,
Employee_Title ,
Employee_Name ,
FathersName ,
MothersName ,
NomineeName ,
Gender,
Occupation,
Division,
Grade ,
Emp_Attendance ,
BloodGroup ,
DateOfBirth ,
Present_Res_No ,
Present_Res_Name,
Present_Road ,
Present_Area ,
Present_City ,
Present_State ,
Present_Pincode ,
Permanent_Res_No ,
Permanent_Res_Name ,
Permanent_Road ,
Permanent_Area ,
Permanent_City,
Permanent_State ,
Permanent_Pincode ,
Marital_Status ,
Ward_Circle ,
BankAcNo,
Bank_Name,
Branch_Name,
Email_ID,
Is_Default_EmailId,
Alt_Email_ID,
Is_Default_Alt_EmailId,
CC_Email_ID,
STD_Code,
PhoneNo,
Mobile,
PANno,
AAdhar_No,
VoterId,
PassportNo,
Marriage_Date,
Department_Id,
Desig_Id,
Emp_Cate_Id ,
Employee_Image,
Date_of_Join,
Salary_Calc_From,
Is_Leaving,
Date_of_Leave,
Reason_Of_Leave,
Past_Service_inDay,
IsESI,
ESI_No,
ESI_Dispensary,
IsPF,
PF_No,
PF_Dept_File,
Is_Restrict_PF,
Is_Zero_Pension,
Is_Zero_PT,
IsGRI,
GRI_No,
IsInsurance,
Insurance_No,
IsDisabled,
IsInternationalworker,
IsHigherEPF,
IsHigherEPS,Created_By,Created_On FROM Employee_Details WHERE Is_Deleted=0
   END 
   
   
   

     
   IF @Operation='SELECTBYID'
   BEGIN
   SELECT EmployeeId ,Employee_Code,
Employee_Title ,
Employee_Name ,
FathersName ,
MothersName ,
NomineeName ,
Gender,
Occupation,
Division,
Grade ,
Emp_Attendance ,
BloodGroup ,
DateOfBirth ,
Present_Res_No ,
Present_Res_Name,
Present_Road ,
Present_Area ,
Present_City ,
Present_State ,
Present_Pincode ,
Permanent_Res_No ,
Permanent_Res_Name ,
Permanent_Road ,
Permanent_Area ,
Permanent_City,
Permanent_State ,
Permanent_Pincode ,
Marital_Status ,
Ward_Circle ,
BankAcNo,
Bank_Name,
Branch_Name,
Email_ID,
Is_Default_EmailId,
Alt_Email_ID,
Is_Default_Alt_EmailId,
CC_Email_ID,
STD_Code,
PhoneNo,
Mobile,
PANno,
AAdhar_No,
VoterId,
PassportNo,
Marriage_Date,
Department_Id,
Desig_Id,
Emp_Cate_Id ,
Employee_Image,
Date_of_Join,
Salary_Calc_From,
Is_Leaving,
Date_of_Leave,
Reason_Of_Leave,
Past_Service_inDay,
IsESI,
ESI_No,
ESI_Dispensary,
IsPF,
PF_No,
PF_Dept_File,
Is_Restrict_PF,
Is_Zero_Pension,
Is_Zero_PT,
IsGRI,
GRI_No,
IsInsurance,
Insurance_No,
IsDisabled,
IsInternationalworker,
IsHigherEPF,
IsHigherEPS,Created_By,Created_On FROM Employee_Details WHERE Is_Deleted=0 AND EmployeeId=@EmployeeId
   END  
   
   IF @Operation = 'DELETE'
   BEGIN
   UPDATE Employee_Details SET Is_Deleted = 1 WHERE EmployeeId=@EmployeeId
   END
   
   
   IF @Operation='SEARCH'
   BEGIN
  select * from Employee_Details where Is_Deleted=0 AND EmployeeId between @OUT_CODE and @OUT_CODE+15
   END
    
   
   
   
   
   
   